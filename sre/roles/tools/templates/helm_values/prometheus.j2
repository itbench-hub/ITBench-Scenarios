---
alertmanager:
  enabled: false
grafana:
  enabled: false
prometheus:
  prometheusSpec:
    podMonitorNamespaceSelector:
      matchLabels:
        it-bench/monitoring: "true"
    podMonitorSelectorNilUsesHelmValues: false
    ruleNamespaceSelector:
      matchLabels:
        it-bench/monitoring: "true"
    ruleSelectorNilUsesHelmValues: false
    serviceMonitorNamespaceSelector:
      matchLabels:
        it-bench/monitoring: "true"
    serviceMonitorSelectorNilUsesHelmValues: false
    additionalArgs:
      - name: web.enable-otlp-receiver
        value: ""
    remoteWrite:
      - url: "http://default:@{{ tools_instances.clickhouse.name }}-{{ tools_instances.clickhouse.name }}.{{ tools_instances.clickhouse.namespace }}.svc.cluster.local:9363/write"
        queueConfig:
          maxSamplesPerSend: 5000
          batchSendDeadline: 10s
{% if tools_installation_plan.istio.enabled | default(false) %}
    routePrefix: /prometheus
{% endif %}
customRules:
  KubeContainerWaiting:
    for: 5m
  KubeHpaMaxedOut:
    for: 5m
  KubePodCrashLooping:
    for: 5m
  KubePodNotReady:
    for: 5m
defaultRules:
  rules:
    alertmanager: false
kubeControllerManager:
  enabled: {{ tools_cluster.provider == "kind" }}
kubeEtcd:
  enabled: {{ tools_cluster.provider == "kind" }}
kubeProxy:
  enabled: {{ tools_cluster.provider == "kind" }}
kubeScheduler:
  enabled: {{ tools_cluster.provider == "kind" }}


          ruleSelectorNilUsesHelmValues: false
          serviceMonitorNamespaceSelector:
            matchLabels:
              it-bench/monitoring: "true"
          serviceMonitorSelectorNilUsesHelmValues: false
          additionalArgs:
            - name: web.enable-otlp-receiver
              value: ""
          remoteWrite:
            - url: "http://default:@{{ tools_instances.clickhouse.name }}-{{ tools_instances.clickhouse.name }}.{{ tools_instances.clickhouse.namespace }}.svc.cluster.local:9363/write"
              queueConfig:
                maxSamplesPerSend: 5000
                batchSendDeadline: 10s
      defaultRules:
        rules:
          alertmanager: false
      kubeEtcd:
        enabled: "{{ tools_cluster.provider == 'kind' }}"
      kubeProxy:
        enabled: "{{ tools_cluster.provider == 'kind' }}"
    wait: true
  when:
    - tools_cluster.platform == "kubernetes"