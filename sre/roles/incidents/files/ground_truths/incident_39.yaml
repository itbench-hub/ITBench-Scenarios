---
metadata:
  version: "v1"
fault:
  - entity:
      name: payment-pdb-1
      group_id: payment-pdb-1
      kind: PodDisruptionBudget
    condition: Overly restrictive PDB (minAvailable=2) blocks pod eviction during node drain
    category: Configuration
    fault_mechanism: pdb-blocking-drain
alerts:
  - id: RequestLatency
    group_id: payment-service-1
    metadata:
      description: Payment service latency increased due to pod stuck on stressed node
  - id: RequestErrorRate
    group_id: payment-service-1
    metadata:
      description: Payment service experiencing errors as node becomes unhealthy
groups:
  - id: payment-pdb-1
    kind: PodDisruptionBudget
    filter:
      - payment-pdb
    namespace: otel-demo
    root_cause: true
  - id: payment-service-1
    kind: Service
    filter:
      - payment\b
    namespace: otel-demo
  - id: payment-pod-1
    kind: Pod
    filter:
      - payment-.*
    namespace: otel-demo
aliases:
  - - payment-service-1
    - payment-pod-1
propagations:
  - source: payment-pdb-1
    target: payment-pod-1
    condition: PDB prevents pod eviction during node drain operation
    effect: Pod remains stuck on node undergoing maintenance/stress
  - source: payment-pod-1
    target: payment-service-1
    condition: Pod experiencing degraded performance on stressed node
    effect: Payment service latency increases and error rate rises
recommended_actions:
  - solution:
      id: relax_pdb_constraints
      actions:
        - Update PDB to use maxUnavailable instead of minAvailable
        - Set maxUnavailable to 1 to allow controlled disruptions
  - solution:
      id: force_drain_completion
      actions:
        - Temporarily delete PDB to complete drain operation
        - Recreate PDB with appropriate constraints after maintenance
