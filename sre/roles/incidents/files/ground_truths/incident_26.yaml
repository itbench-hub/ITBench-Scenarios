---
fault:
  - entity:
      name: tamper-body-otel-demo-emailservice-1
      group_id: tamper-body-otel-demo-emailservice-1
      kind: HttpChaos
    condition: HTTP Chaos fault tampering POST request body to email service with corrupted JSON payload
    category: Chaos
    fault_mechanism: chaos
alerts:
  - id: RequestErrorRate
    group_id: email-service-1
    metadata:
      description: Request error rate in service email in namespace otel-demo is above 0
  - id: RequestErrorRate
    group_id: checkout-service-1
    metadata:
      description: Request error rate in service checkout in namespace otel-demo is above 0
groups:
  - id: tamper-body-otel-demo-emailservice-1
    kind: HttpChaos
    filter:
      - otel-demo-email-http-chaos-post-body-tamper
    namespace: chaos-mesh
    root_cause: true
  - id: email-service-1
    kind: Service
    filter:
      - email\b
    namespace: otel-demo
  - id: email-pod-1
    kind: Pod
    filter:
      - email-.*
    namespace: otel-demo
  - id: checkout-service-1
    kind: Service
    filter:
      - checkout\b
    namespace: otel-demo
  - id: checkout-pod-1
    kind: Pod
    filter:
      - checkout-.*
    namespace: otel-demo
aliases:
  - - email-service-1
    - email-pod-1
  - - checkout-service-1
    - checkout-pod-1
propagations:
  - source: tamper-body-otel-demo-emailservice-1
    target: email-service-1
    condition: HTTP Chaos tampers POST request bodies with invalid JSON payload
    effect: Email service receives corrupted requests and fails to process them
  - source: email-service-1
    target: checkout-service-1
    condition: Email service returns errors due to corrupted request payload
    effect: Checkout service experiences errors when sending order confirmation emails
recommended_actions:
  - solution:
      id: remove_chaos_experiment
      actions:
        - Delete the HTTP Chaos resource tampering email service requests
