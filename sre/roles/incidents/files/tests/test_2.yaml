---
metadata:
  id: 2
  name: Test Chaos Mesh Faults
spec:
  environment:
    applications:
      - otel-demo
    kubernetes:
      additions: []
      modifications: []
    tools:
      category: ""
      selected:
        - jaeger
        - clickhouse
        - prometheus
  faults:
    - chaos_mesh:
        experiments:
          - name: otel-demo-email-http-chaos-post-body-tamper
            spec:
              schedule: "* * * * *"
              historyLimit: 1
              concurrencyPolicy: Forbid
              type: HTTPChaos
              httpChaos:
                mode: all
                target: Request
                port: 8080
                method: POST
                path: '*'
                selector:
                  namespaces:
                    - "{{ applications_helm_releases.otel_demo.namespace }}"
                  labelSelectors:
                    "app.kubernetes.io/component": "email"
                patch:
                  body:
                    type: JSON
                    value: '{"email": "12345", "order": "error body"}'
                duration: "55s"
