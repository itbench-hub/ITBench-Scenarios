[
    {
        "alerts": {
            "application": [
                "KubePodNotReady"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject"
                ],
                "type": "object"
            }
        },
        "description": "This fault places a workload on a node and prevents it from scaling by blocking all new scheduling attempts.",
        "expectation": "The faulted pod(s) will enter the `Pending` state due to an `FailedScheduling` warning. Thus, the new pod will not start running.",
        "id": "cordoned-kubernetes-worker-node",
        "name": "Cordoned Kubernetes Worker Node",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/architecture/nodes/",
            "https://kubernetes.io/docs/concepts/workloads/",
            "https://kubernetes.io/docs/tasks/administer-cluster/safely-drain-node/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} rollout undo {{ args.kubernetesObject.kind | lower }}/{{ args.kubernetesObject.metadata.name }}",
                            "text": "Revert the last change done to the manifest."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and replace the node selector with the correct value."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl get nodes --selector='node-role.kubernetes.io/node='",
                            "text": "Retrieve all worker node nodes"
                        },
                        {
                            "text": "Uncordon all worker nodes which are cordoned."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Performance"
        ]
    },
    {
        "alerts": {
            "application": [
                "NoRequestsReceived"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "httpMethods": {
                        "items": {
                            "enum": [
                                "GET",
                                "POST",
                                "DELETE",
                                "PUT"
                            ],
                            "type": "string"
                        },
                        "type": "array"
                    },
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Namespace"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject"
                ],
                "type": "object"
            }
        },
        "description": "This fault modifies a namespace, disabling it from being included in Istio's Ambient Mode service mesh.",
        "expectation": "No traffic will be routed through the service mesh. This would all the requests to not be processed with the various policies configured in Istio.",
        "id": "disabled-istio-ambient-mode-kubernetes-namespace",
        "name": "Disabled Istio Ambient Mode Kubernetes Namespace",
        "platform": "Kubernetes",
        "resources": [
            "https://istio.io/latest/docs/ambient/overview/",
            "https://istio.io/latest/docs/ambient/usage/add-workloads/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.name }} edit namespace {{ args.kubernetesObject.metadata.name }}-deny",
                            "text": "Manually edit the manifest and replace the invalid label with the correct value."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Networking"
        ]
    },
    {
        "alerts": {
            "goldenSignal": [
                "HighRequestErrorRate"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject"
                ],
                "type": "object"
            }
        },
        "description": "This fault injects an DNS policy which results in the workload being unable to resolve the name of outgoing services.",
        "expectation": "All outgoing requests made by the workload will failed due to being unable to resolve the DNS name.",
        "id": "failing-name-resolution-kubernetes-workload-dns-policy",
        "name": "Failing Name Resolution Kubernetes Workload DNS Policy",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/services-networking/dns-pod-service/",
            "https://kubernetes.io/docs/concepts/workloads/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit authorizationpolicy {{ args.kubernetesObject.metadata.name }}-deny",
                            "text": "Manually edit the manifest and replace the invalid rule with the correct value."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} delete authorizationpolicy {{ args.kubernetesObject.metadata.name }}-deny",
                            "text": "Delete the faulty authorization policy."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Networking"
        ]
    },
    {
        "alerts": {
            "application": [
                "KubeContainerWaiting"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject"
                ],
                "type": "object"
            }
        },
        "description": "This fault injects an init container which will hang into a workload.",
        "expectation": "The faulted pod will enter the `Pending` state. All containers will be in the `Waiting` state. The hanging init container will be in the `Running` state.",
        "id": "hanging-kubernetes-workload-init-container",
        "name": "Hanging Kubernetes Workload Init Container",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/workloads/pods/init-containers/",
            "https://kubernetes.io/docs/concepts/workloads/",
            "https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} rollout undo {{ args.kubernetesObject.kind | lower }}/{{ args.kubernetesObject.metadata.name }}",
                            "text": "Revert the last change done to the manifest."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and replace the command of the hanging init container to one which will complete."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and remove the faulty init container."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Performance"
        ]
    },
    {
        "alerts": {
            "application": [
                "NoRequestsReceived"
            ],
            "goldenSignal": [
                "HighRequestErrorRate"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject"
                ],
                "type": "object"
            }
        },
        "description": "This fault injects a network policy which blocks traffic on all ingress ports of a given workload.",
        "expectation": "Other workloads will be unable to communicate with the faulted pod(s) on the correct port. This usually results in increased latency and errors in applications.",
        "id": "ingress-port-blocking-network-policy",
        "name": "Ingress Port Blocking Network Policy",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/workloads/",
            "https://kubernetes.io/docs/concepts/services-networking/network-policies/",
            "https://kubernetes.io/docs/tasks/administer-cluster/quota-api-object/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/",
            "https://kubernetes.io/docs/reference/kubernetes-api/policy-resources/network-policy-v1/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} get networkpolicy",
                            "text": "Retrieve and review the configuration of the network policy(s) in the affected namespace."
                        },
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit networkpolicy {{ args.kubernetesObject.metadata.name }}-deny",
                            "text": "Manually edit the manifest(s) and allow access to workload's ports of the network policy(s)."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} get networkpolicy",
                            "text": "Retrieve and review the configuration of the network policy(s) in the affected namespace."
                        },
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit networkpolicy {{ args.kubernetesObject.metadata.name }}-deny",
                            "text": "Delete the offending network policy(s) if it is no longer required."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Networking"
        ]
    },
    {
        "alerts": {
            "application": [
                "KubePodNotReady"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject"
                ],
                "type": "object"
            }
        },
        "description": "This fault injects a resource quota with hard resource requirements that are underprovisioned for the namespace.",
        "expectation": "The new pod(s) for the workload in the faulted namespace will enter the `Pending` state.",
        "id": "insufficent-kubernetes-resource-quota",
        "name": "Insufficent Kubernetes Resource Quota",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/workloads/",
            "https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/",
            "https://kubernetes.io/docs/concepts/policy/resource-quotas/",
            "https://kubernetes.io/docs/tasks/administer-cluster/quota-api-object/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/",
            "https://kubernetes.io/docs/reference/kubernetes-api/policy-resources/resource-quota-v1/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} get resourcequota",
                            "text": "Retrieve and review the configuration of the resource quota(s) in the affected namespace."
                        },
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit resourcequota {{ args.kubernetesObject.metadata.namespace }}",
                            "text": "Manually edit the manifest(s) and increase the values of the resource quota(s)."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} get resourcequota",
                            "text": "Retrieve and review the configuration of the resource quota(s) in the affected namespace."
                        },
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} delete resourcequota {{ args.kubernetesObject.metadata.namespace }}",
                            "text": "Delete the offending resource quota(s) if it is no longer required."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Performance"
        ]
    },
    {
        "alerts": {
            "application": [
                "KubePodCrashLooping"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "container": {
                        "properties": {
                            "name": {
                                "type": "string"
                            }
                        },
                        "required": [
                            "name"
                        ],
                        "type": "object"
                    },
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject",
                    "container"
                ],
                "type": "object"
            }
        },
        "description": "This fault injects a insufficient resource configuration into a designated Kubernetes workload's container.",
        "expectation": "The faulted pod(s) will enter the `CrashLoopBackOff` state and container will enter the `Terminated` state. The workload will become unable to function for long periods.",
        "id": "insufficent-kubernetes-workload-container-resources",
        "name": "Insufficent Kubernetes Workload Container Resources",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/containers/images/",
            "https://kubernetes.io/docs/concepts/workloads/",
            "https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} rollout undo {{ args.kubernetesObject.kind | lower }}/{{ args.kubernetesObject.metadata.name }}",
                            "text": "Revert the last change done to the manifest."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and replace the invalid container's resource configuration with the correct value(s)."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Performance"
        ]
    },
    {
        "alerts": {
            "application": [
                "KubePodCrashLooping"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "container": {
                        "properties": {
                            "name": {
                                "type": "string"
                            }
                        },
                        "required": [
                            "name"
                        ],
                        "type": "object"
                    },
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject",
                    "container"
                ],
                "type": "object"
            }
        },
        "description": "This fault injects an invalid command into a designated Kubernetes workload's container.",
        "expectation": "The faulted pod(s) will enter the `CrashLoopBackOff` state and container will enter the `Terminated` state. The workload will become unable to function.",
        "id": "invalid-kubernetes-workload-container-command",
        "name": "Invalid Kubernetes Workload Container Command",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/containers/images/",
            "https://kubernetes.io/docs/concepts/workloads/",
            "https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} rollout undo {{ args.kubernetesObject.kind | lower }}/{{ args.kubernetesObject.metadata.name }}",
                            "text": "Revert the last change done to the manifest."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and replace the invalid command with the correct value."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Performance"
        ]
    },
    {
        "alerts": {
            "goldenSignal": [
                "HighRequestLatency"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject"
                ],
                "type": "object"
            }
        },
        "description": "This fault changes the password of a Valkey workload.",
        "expectation": "Other workloads will be unable to authorize themselves with the Valkey workload. This usually causes increased latency and errors in applications.",
        "id": "invalid-valkey-password",
        "name": "Invalid Valkey Password",
        "platform": "Kubernetes",
        "resources": [
            "https://valkey.io/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} exec {{ args.kubernetesObject.kind | lower }}/{{ args.kubernetesObject.metadata.name }} -- valkey-cli CONFIG SET requirepass ''",
                            "text": "Change the password back to the original by access the pod directly."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Authentication"
        ]
    },
    {
        "alerts": {
            "application": [
                "KubeHpaMaxedOut"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject"
                ],
                "type": "object"
            }
        },
        "description": "This fault injects a configuration into a horizontal pod autoscaler that causes it to react to low resource usage",
        "expectation": "The faulted autoscaler will take scale up or down actions more aggressively (often more than required).",
        "id": "misconfigured-kubernetes-horizontal-pod-autoscaler",
        "name": "Misconfigured Kubernetes Horizontal Pod Autoscaler",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/workloads/autoscaling/",
            "https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/",
            "https://kubernetes.io/docs/tasks/run-application/horizontal-pod-autoscale-walkthrough/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/horizontal-pod-autoscaler-v2/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit horizontalpodautoscaler {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and replace the utilization values with the correct values."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Performance"
        ]
    },
    {
        "alerts": {
            "application": [
                "KubePodNotReady"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject"
                ],
                "type": "object"
            }
        },
        "description": "This fault injects a misconfigured readiness probe into a workload container. This probe blocks the pod from starting up.",
        "expectation": "The faulted pod(s) will enter the `Pending` state due to a `ContainersNotReady` reason for the `Ready` condition.",
        "id": "misconfigured-kuberntes-workload-container-readiness-probe",
        "name": "Misconfigured Kuberntes Workload Container Readiness Probe",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/configuration/liveness-readiness-startup-probes/",
            "https://kubernetes.io/docs/concepts/workloads/",
            "https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} rollout undo {{ args.kubernetesObject.kind | lower }}/{{ args.kubernetesObject.metadata.name }}",
                            "text": "Revert the last change done to the manifest."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and remove the faulty readiness probe in the container rule."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Performance"
        ]
    },
    {
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "container": {
                        "properties": {
                            "env": {
                                "items": {
                                    "properties": {
                                        "name": {
                                            "type": "string"
                                        },
                                        "value": {
                                            "type": "string"
                                        }
                                    },
                                    "required": [
                                        "name",
                                        "value"
                                    ],
                                    "type": "object"
                                },
                                "type": "array"
                            },
                            "name": {
                                "type": "string"
                            }
                        },
                        "required": [
                            "env",
                            "name"
                        ],
                        "type": "object"
                    },
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject",
                    "container"
                ],
                "type": "object"
            }
        },
        "description": "This fault overwrites an environment variable value with one provided in the argument.",
        "expectation": "Varies based on the effect/purpose of the environment variable.",
        "id": "modified-kubernetes-workload-container-environment-variable",
        "name": "Modified Kubernetes Workload Container Environment Variable",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/workloads/",
            "https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} rollout undo {{ args.kubernetesObject.kind | lower }}/{{ args.kubernetesObject.metadata.name }}",
                            "text": "Revert the last change done to the manifest."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and replace the environment variable(s) value with the correct value(s)."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Performance"
        ]
    },
    {
        "alerts": {
            "goldenSignal": [
                "HighRequestErrorRate"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Service"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    },
                    "targetPort": {
                        "type": "integer"
                    }
                },
                "required": [
                    "kubernetesObject",
                    "targetPort"
                ],
                "type": "object"
            }
        },
        "description": "This fault overwrites the designated target port with a different number.",
        "expectation": "Other workloads will be unable to communicate with the faulted pod(s) on the correct port. This usually results in increased latency and errors in applications.",
        "id": "modified-target-port-kubernetes-service",
        "name": "Modified Target Port Kubernetes Service",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/workloads/",
            "https://kubernetes.io/docs/concepts/services-networking/service/",
            "https://kubernetes.io/docs/tasks/access-application-cluster/connecting-frontend-backend/",
            "https://kubernetes.io/docs/reference/kubernetes-api/service-resources/service-v1/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and replace the target port ({{ args.targetPort }}) with the correct value."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Networking"
        ]
    },
    {
        "alerts": {
            "application": [
                "KubePodNotReady"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "container": {
                        "properties": {
                            "name": {
                                "type": "string"
                            }
                        },
                        "required": [
                            "name"
                        ],
                        "type": "object"
                    },
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject",
                    "container"
                ],
                "type": "object"
            }
        },
        "description": "This fault injects an nonexistent image into a designated Kubernetes workload's container.",
        "expectation": "The faulted pod(s) will enter the `Pending` state due to an `ImagePullBackOff` error. The workload will become unable to function.",
        "id": "nonexistent-kubernetes-workload-container-image",
        "name": "Nonexistent Kubernetes Workload Container Image",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/containers/images/",
            "https://kubernetes.io/docs/concepts/workloads/",
            "https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} rollout undo {{ args.kubernetesObject.kind | lower }}/{{ args.kubernetesObject.metadata.name }}",
                            "text": "Revert the last change done to the manifest."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and replace the invalid image with the correct value."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Performance"
        ]
    },
    {
        "alerts": {
            "application": [
                "KubePodNotReady"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject"
                ],
                "type": "object"
            }
        },
        "description": "This fault injects a node selector for an nonexistent node into a designated Kubernetes workload.",
        "expectation": "The faulted pod(s) will enter the `Pending` state. The workload will become unable to function.",
        "id": "nonexistent-kubernetes-workload-node",
        "name": "Nonexistent Kubernetes Workload Node",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/architecture/nodes/",
            "https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/",
            "https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/",
            "https://kubernetes.io/docs/tasks/configure-pod-container/assign-pods-nodes/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} rollout undo {{ args.kubernetesObject.kind | lower }}/{{ args.kubernetesObject.metadata.name }}",
                            "text": "Revert the last change done to the manifest."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and replace the node selector with the correct value."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Performance"
        ]
    },
    {
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "flag": {
                        "properties": {
                            "name": {
                                "type": "string"
                            },
                            "state": {
                                "type": "string"
                            }
                        },
                        "required": [
                            "name",
                            "state"
                        ],
                        "type": "object"
                    },
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "ConfigMap"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "enum": [
                                            "flagd-config"
                                        ],
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject",
                    "flag"
                ],
                "type": "object"
            }
        },
        "description": "This fault activates an implemented fault in the OpenTelemetry Demo.",
        "expectation": "The effects of the faults are listed [here](https://opentelemetry.io/docs/demo/feature-flags/#implemented-feature-flags).",
        "id": "opentelemetry-demo-feature-flag",
        "name": "OpenTelemetry Demo Feature Flag",
        "platform": "Kubernetes",
        "resources": [
            "https://opentelemetry.io/docs/demo/",
            "https://opentelemetry.io/docs/demo/feature-flags/",
            "https://opentelemetry.io/docs/demo/services/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit configmap {{ args.kubernetesObject.metadata.name }}",
                            "text": "Disable the feature flag ({{ args.flag.name }}) by manually editing the contents of the ConfigMap"
                        },
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} rollout restart deployment",
                            "text": "Restart all of the Deployment workloads."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Performance"
        ]
    },
    {
        "alerts": {
            "application": [
                "KubePodNotReady"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject"
                ],
                "type": "object"
            }
        },
        "description": "This fault causes a workload to be a lower priority than another. This causes the pod to be evicted when the higher priority workload needs more resources.",
        "expectation": "The faulted pod(s) will enter the `Pending` state due to an `FailedScheduling` warning. Thus, the new pod will not start running.",
        "id": "priority-kubernetes-workload-priority-preemption",
        "name": "Priority Kubernetes Workload Priority Preemption",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/scheduling-eviction/pod-priority-preemption/",
            "https://kubernetes.io/docs/concepts/scheduling-eviction/node-pressure-eviction/",
            "https://kubernetes.io/docs/concepts/workloads/",
            "https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} rollout undo {{ args.kubernetesObject.kind | lower }}/{{ args.kubernetesObject.metadata.name }}",
                            "text": "Revert the last change done to the manifest."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and remove the node selector value with the correct value(s)."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "text": "Create a new priority class with a higher value than the workload which caused its preemption."
                        },
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and change the priority of the workload to the new priority."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Performance"
        ]
    },
    {
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "chaos-mesh.org/v1alpha1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Schedule"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    },
                    "scheduleSpec": {
                        "properties": {
                            "type": {
                                "type": "string"
                            }
                        },
                        "required": [
                            "type"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject",
                    "scheduleSpec"
                ],
                "type": "object"
            }
        },
        "description": "This fault injects a Chaos Mesh experiment into the environment. The experiment is [scheduled](https://chaos-mesh.org/docs/define-scheduling-rules/) to repeated fire so that the behavior persists.",
        "expectation": "Varies based on the Chaos Mesh experiment used.",
        "id": "scheduled-chaos-mesh-experiment",
        "name": "Scheduled Chaos Mesh Experiment",
        "platform": "Kubernetes",
        "resources": [
            "https://chaos-mesh.org/docs/run-a-chaos-experiment/",
            "https://chaos-mesh.org/docs/developer-guide-overview/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} annotate schedule {{ args.kubernetesObject.metadata.name }} experiment.chaos-mesh.org/pause='true'",
                            "text": "Annotate the schedule to pause the active experiment."
                        },
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} get {{ args.scheduleSpec.type | lower }} --selector='experiment.chaos-mesh.org/pause=true'",
                            "text": "Retrieve the associated experiment managed by the schedule."
                        },
                        {
                            "text": "Delete the retrieved experiement after it has entered the `Paused` state."
                        },
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} delete schedule {{ args.kubernetesObject.metadata.name }} experiment.chaos-mesh.org/pause='true'",
                            "text": "Delete the schedule."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Performance"
        ]
    },
    {
        "alerts": {
            "goldenSignal": [
                "HighRequestErrorRate"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject"
                ],
                "type": "object"
            }
        },
        "description": "This fault injects a policy which causes the affected workload to be unable to communicate with other pods in the service mesh.",
        "expectation": "The faulted pod will be unable to succesfully make requests to other pods, causing the error rate to increase.",
        "id": "strict-mutual-tls-istio-service-mesh-enforcement",
        "name": "Strict Mutual TLS Istio Service Mesh Enforcement",
        "platform": "Kubernetes",
        "resources": [
            "https://istio.io/latest/docs/ambient/usage/add-workloads/",
            "https://istio.io/latest/docs/tasks/security/authentication/mtls-migration/",
            "https://istio.io/latest/docs/ambient/usage/verify-mtls-enabled/",
            "https://kubernetes.io/docs/concepts/workloads/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and to add the required Istio ambient mode labels to the workload."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl edit namespace {{ args.kubernetesObject.metadata.namespace }}",
                            "text": "Manually edit the namespace manifest and to add the required Istio ambient mode labels to the workload."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Networking"
        ]
    },
    {
        "alerts": {
            "application": [
                "NoRequestsReceived"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "httpMethods": {
                        "items": {
                            "enum": [
                                "GET",
                                "POST",
                                "DELETE",
                                "PUT"
                            ],
                            "type": "string"
                        },
                        "type": "array"
                    },
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "gateway.networking.k8s.io"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Gateway"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "httpMethods",
                    "kubernetesObject"
                ],
                "type": "object"
            }
        },
        "description": "This fault injects an authorization policy which denies all HTTP requests to a Kubernetes Gateway.",
        "expectation": "All HTTP requests of the specified methods will be blocked, resulting in a 403 status code in the response.",
        "id": "traffic-denying-istio-gateway-authorization-policy",
        "name": "Traffic Denying Istio Gateway Authorization Policy",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/services-networking/gateway/",
            "https://gateway-api.sigs.k8s.io/",
            "https://istio.io/latest/docs/reference/config/security/authorization-policy/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit authorizationpolicy {{ args.kubernetesObject.metadata.name }}-deny",
                            "text": "Manually edit the manifest and replace the invalid rule with the correct value."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} delete authorizationpolicy {{ args.kubernetesObject.metadata.name }}-deny",
                            "text": "Delete the faulty authorization policy."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Networking"
        ]
    },
    {
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject"
                ],
                "type": "object"
            }
        },
        "description": "This fault removes the resource limits of an indicated workload container.",
        "expectation": "The new pod will run normally. However, without resource limits, the pod will consume resources endless. This state can be combined with other faults to produce resource usage scenarios.",
        "id": "unassigned-kubernetes-workload-container-resource-limits",
        "name": "Unassigned Kubernetes Workload Container Resource Limits",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/containers/images/",
            "https://kubernetes.io/docs/concepts/workloads/",
            "https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} rollout undo {{ args.kubernetesObject.kind | lower }}/{{ args.kubernetesObject.metadata.name }}",
                            "text": "Revert the last change done to the manifest."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and replace the invalid container's resource configuration with the correct value(s)."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Performance"
        ]
    },
    {
        "alerts": {
            "application": [
                "KubePodNotReady"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject"
                ],
                "type": "object"
            }
        },
        "description": "This fault injects an Inter-Pod Anti-Affinity which causes Kubernetes to be unable to schedule the pod.",
        "expectation": "The faulted pod(s) will enter the `Pending` state due to an `FailedScheduling` warning. Thus, the new pod will not start running.",
        "id": "unschedueable-kuberntes-workload-pod-anti-affinity-rule",
        "name": "Unschedueable Kuberntes Workload Pod Anti Affinity Rule",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/scheduling-eviction/assign-pod-node/",
            "https://kubernetes.io/docs/concepts/workloads/",
            "https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} rollout undo {{ args.kubernetesObject.kind | lower }}/{{ args.kubernetesObject.metadata.name }}",
                            "text": "Revert the last change done to the manifest."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and remove the faulty pod anti-affinity rule with the correct value."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Performance"
        ]
    },
    {
        "alerts": {
            "application": [
                "KubePodNotReady"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "container": {
                        "properties": {
                            "name": {
                                "type": "string"
                            }
                        },
                        "required": [
                            "name"
                        ],
                        "type": "object"
                    },
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject",
                    "container"
                ],
                "type": "object"
            }
        },
        "description": "This fault injects an image with an unsupported architecture into a designated Kubernetes workload's container and assigns it to a node.",
        "expectation": "The faulted pod(s) will enter the `Pending` state due to an `ImagePullBackOff` error. The workload will become unable to function.",
        "id": "unsupported-architecture-kubernetes-workload-container-image",
        "name": "Unsupported Architecture Kubernetes Workload Container Image",
        "platform": "Kubernetes",
        "resources": [
            "https://kubernetes.io/docs/concepts/containers/images/",
            "https://kubernetes.io/docs/concepts/workloads/",
            "https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} rollout undo {{ args.kubernetesObject.kind | lower }}/{{ args.kubernetesObject.metadata.name }}",
                            "text": "Revert the last change done to the manifest."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and replace the invalid image with the correct value."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and replace the node selector to allow Kubernetes to schedule the workload on a supported node (if exists)."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Performance"
        ]
    },
    {
        "alerts": {
            "application": [
                "KubePodCrashLooping"
            ]
        },
        "arguments": {
            "jsonSchema": {
                "properties": {
                    "container": {
                        "properties": {
                            "name": {
                                "type": "string"
                            }
                        },
                        "required": [
                            "name"
                        ],
                        "type": "object"
                    },
                    "kubernetesObject": {
                        "properties": {
                            "apiVersion": {
                                "enum": [
                                    "apps/v1"
                                ],
                                "type": "string"
                            },
                            "kind": {
                                "enum": [
                                    "Deployment",
                                    "StatefulSet"
                                ],
                                "type": "string"
                            },
                            "metadata": {
                                "properties": {
                                    "name": {
                                        "type": "string"
                                    },
                                    "namespace": {
                                        "type": "string"
                                    }
                                },
                                "required": [
                                    "name",
                                    "namespace"
                                ],
                                "type": "object"
                            }
                        },
                        "required": [
                            "apiVersion",
                            "kind",
                            "metadata"
                        ],
                        "type": "object"
                    }
                },
                "required": [
                    "kubernetesObject",
                    "container"
                ],
                "type": "object"
            }
        },
        "description": "This fault adds a code change to a Valkey workload. This modifies the container to also contain a process which will consume memory.",
        "expectation": "The faulted pod(s) will enter the `CrashLoopBackOff` state and container will enter the `Terminated` state. The workload will become unable to function.",
        "id": "valkey-workload-out-of-memory",
        "name": "Valkey Workload Out of Memory",
        "platform": "Kubernetes",
        "resources": [
            "https://valkey.io/",
            "https://kubernetes.io/docs/concepts/workloads/",
            "https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/",
            "https://kubernetes.io/docs/reference/kubernetes-api/workload-resources/"
        ],
        "solutions": {
            "templates": [
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} rollout undo {{ args.kubernetesObject.kind | lower }}/{{ args.kubernetesObject.metadata.name }}",
                            "text": "Revert the last change done to the manifest."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit {{ args.kubernetesObject.kind | lower }} {{ args.kubernetesObject.metadata.name }}",
                            "text": "Manually edit the manifest and remove the code change volumes."
                        },
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} delete configmap valkey-storage-script",
                            "text": "Delete the injected ConfigMap object."
                        }
                    ]
                },
                {
                    "steps": [
                        {
                            "command": "kubectl -n {{ args.kubernetesObject.metadata.namespace }} edit configmap valkey-storage-script",
                            "text": "Manually edit the manifest and change the script."
                        }
                    ]
                }
            ]
        },
        "tags": [
            "Deployment",
            "Code"
        ]
    }
]
