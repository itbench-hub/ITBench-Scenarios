---
apiVersion: itbench.io/v1
kind: GroundTruth
metadata:
  name: scenario-31
spec:
  alerts:
    - group_id: frontend-proxy-service-1
      id: RequestErrorRate
      metadata:
        description: Frontend proxy cannot reach frontend service due to network policy blocking ingress
  aliases:
    - - frontend-service-1
      - frontend-pod-1
    - - frontend-proxy-service-1
      - frontend-proxy-pod-1
  fault:
    - category: Configuration
      condition: NetworkPolicy blocks all ingress traffic to frontend pods
      entity:
        group_id: frontend-pod-1
        kind: Pod
        name: frontend-pod-1
      fault_mechanism: misconfigured-network-policy
  groups:
    - filter:
        - frontend-.*
      id: frontend-pod-1
      kind: Pod
      namespace: otel-demo
      root_cause: true
    - filter:
        - frontend\b
      id: frontend-service-1
      kind: Service
      namespace: otel-demo
    - filter:
        - frontend-proxy-.*
      id: frontend-proxy-pod-1
      kind: Pod
    - filter:
        - frontend-proxy\b
      id: frontend-proxy-service-1
      kind: Service
      namespace: otel-demo
  propagations:
    - condition: NetworkPolicy blocks all ingress traffic to frontend pods
      effect: Frontend service cannot receive traffic, making it completely unavailable
      source: frontend-pod-1
      target: frontend-service-1
    - condition: Frontend proxy cannot connect to frontend service due to network policy
      effect: All user requests through proxy fail with connection errors
      source: frontend-service-1
      target: frontend-proxy-1
  recommendedActions:
    - solution:
        actions:
          - Identify and remove the NetworkPolicy blocking ingress to frontend pods
        id: remove_blocking_network_policy
