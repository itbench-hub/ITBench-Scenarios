---
- name: Delete RoleBinding
  kubernetes.core.k8s:
    api_version: rbac.authorization.k8s.io/v1
    delete_all: true
    kind: RoleBinding
    kubeconfig: "{{ agent_cluster.kubeconfig }}"
    namespace: "{{ namespace.name }}"
    label_selectors:
      - app.kubernetes.io/part-of = it-bench
    state: absent
    wait: true

- name: Delete Role
  kubernetes.core.k8s:
    api_version: rbac.authorization.k8s.io/v1
    delete_all: true
    kind: Role
    kubeconfig: "{{ agent_cluster.kubeconfig }}"
    namespace: "{{ namespace.name }}"
    label_selectors:
      - app.kubernetes.io/part-of = it-bench
    state: absent
    wait: true

- name: Delete Service Account
  kubernetes.core.k8s:
    api_version: v1
    delete_all: true
    kind: ServiceAccount
    kubeconfig: "{{ agent_cluster.kubeconfig }}"
    namespace: "{{ namespace.name }}"
    label_selectors:
      - app.kubernetes.io/part-of = it-bench
    state: absent
    wait: true
