---
- name: Import AWX installation tasks
  ansible.builtin.import_tasks:
    file: install_awx.yaml
  tags:
    - install_tools

- name: Include AWX job installation tasks
  ansible.builtin.include_tasks:
    file: install_jobs.yaml
    apply:
      tags:
        - install_tools
  loop: "{{ awx_experiments.incidents }}"
  loop_control:
    loop_var: incident
    index_var: incident_index
  tags:
    - install_tools

- name: Import AWX workflow installation tasks
  ansible.builtin.include_tasks:
    file: install_workflows.yaml
    apply:
      tags:
        - install_tools
  loop: "{{ awx_experiments.incidents }}"
  loop_control:
    loop_var: incident
  tags:
    - install_tools

- name: Import AWX workflow launch tasks
  ansible.builtin.import_tasks:
    file: launch_workflows.yaml

- name: Import AWX uninstallation tasks
  ansible.builtin.import_tasks:
    file: uninstall_awx.yaml
  tags:
    - uninstall_tools
