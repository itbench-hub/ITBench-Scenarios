---
- name: Inject fault (node selector)
  kubernetes.core.k8s:
    kubeconfig: "{{ faults_cluster.kubeconfig }}"
    resource_definition:
      apiVersion: apps/v1
      kind: "{{ manager.kind }}"
      metadata:
        name: "{{ manager.name }}"
        namespace: "{{ manager.namespace }}"
      spec:
        template:
          spec:
            nodeSelector:
              "kubernetes.io/hostname": invalid-node
    state: patched
  loop: "{{ targets }}"
  loop_control:
    label: "{{ manager.kind | lower }}/{{ manager.name }}"
    loop_var: manager
