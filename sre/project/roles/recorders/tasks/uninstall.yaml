---
- name: Import alert recorder uninstallation tasks
  ansible.builtin.import_tasks:
    file: uninstall_alerts_recorders.yaml
  when:
    - recorders_required.alerts is defined

- name: Import topology recorder uninstallation tasks
  ansible.builtin.import_tasks:
    file: uninstall_topology_recorders.yaml
  when:
    - recorders_required.topology is defined

- name: Import traces recorder uninstallation tasks
  ansible.builtin.import_tasks:
    file: uninstall_traces_recorders.yaml
  when:
    - recorders_required.traces is defined

- name: Delete the namespace
  kubernetes.core.k8s:
    kubeconfig: "{{ recorders_cluster.kubeconfig }}"
    resource_definition:
      apiVersion: v1
      kind: Namespace
      metadata:
        name: "{{ recorders_namespace.name }}"
    state: absent
    wait: true
