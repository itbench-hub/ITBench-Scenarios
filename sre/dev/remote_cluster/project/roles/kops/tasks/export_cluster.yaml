---
- name: Export cluster's kubeconfig
  ansible.builtin.command:
    argv:
      - kops
      - export
      - --name
      - "{{ cluster_name }}"
      - kubecfg
      - --admin
      - --state
      - "{{ kops_state_store }}"
      - --kubeconfig
      - /tmp/{{ cluster_name }}.yaml
  register: kops_export_output
  changed_when: kops_export_output.rc == 0

- name: Display file path of kubeconfig
  ansible.builtin.debug:
    msg:
      - "The kubeconfig has been exported to: /tmp/{{ cluster_name }}.yaml"
      - "Run the following command to execute kubectl commands:"
      - export KUBECONFIG=/tmp/{{ cluster_name }}.yaml
